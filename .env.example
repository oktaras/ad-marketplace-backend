# =============================================================================
# Ads Marketplace Backend Environment (API / Worker / Bot)
# =============================================================================
# Copy to backend/.env and provide real secrets.
# Canonical env names only: legacy aliases are intentionally unsupported.

# -----------------------------------------------------------------------------
# Core Runtime + Infrastructure
# -----------------------------------------------------------------------------
NODE_ENV=production
PORT=3000
DATABASE_URL=postgresql://USER:PASSWORD@HOST:5432/DB_NAME?sslmode=require
REDIS_URL=rediss://default:PASSWORD@HOST:6379

# -----------------------------------------------------------------------------
# Security + Rate Limiting
# -----------------------------------------------------------------------------
# Required in production.
JWT_SECRET=replace-with-strong-random-secret
# Comma-separated origins.
CORS_ORIGINS=https://<frontend-domain>,https://telegram.org,https://web.telegram.org
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=100

# -----------------------------------------------------------------------------
# Telegram Bot
# -----------------------------------------------------------------------------
# Required for bot runtime.
TELEGRAM_BOT_TOKEN=
TELEGRAM_BOT_USERNAME=your_bot_username
# Frontend Mini App base URL used in TonConnect manifest links.
MINI_APP_BASE_URL=https://<frontend-domain>
# Set false to keep topics and only rename on close.
DEAL_CHAT_DELETE_TOPICS_ON_CLOSE=true

# Optional MTProto analytics support.
TELEGRAM_API_ID=
TELEGRAM_API_HASH=
# Required only when MTProto user auth/session storage is enabled.
MTPROTO_SESSION_ENCRYPTION_KEY=

# -----------------------------------------------------------------------------
# TON Escrow + Wallets
# -----------------------------------------------------------------------------
TON_NETWORK=testnet
TON_CENTER_API_URL=https://testnet.toncenter.com/api/v2/jsonRPC
TON_CENTER_API_KEY=

# Escrow factory contract address.
ESCROW_FACTORY_ADDRESS=

# Platform wallet (fee receiver / arbiter).
PLATFORM_FEE_WALLET_ADDRESS=
# 24-word mnemonic for platform wallet (required for TON wallet operations).
PLATFORM_MNEMONIC=

# Backend wallet used for escrow factory operations.
BACKEND_WALLET_MNEMONIC=
# Optional explicit backend wallet address; useful for validation/debug.
BACKEND_WALLET_ADDRESS=

# Canonical fee configuration in basis points.
# 500 = 5%
PLATFORM_FEE_BPS=500

# Required in production for attestation signing.
VERIFICATION_SIGNER_SECRET=

# -----------------------------------------------------------------------------
# Currency
# -----------------------------------------------------------------------------
SUPPORTED_CURRENCIES=TON
DEFAULT_CURRENCY=TON

# -----------------------------------------------------------------------------
# Worker Scheduling
# -----------------------------------------------------------------------------
ANALYTICS_REFRESH_ENABLED=true
ANALYTICS_REFRESH_CRON=0 3 * * *
ANALYTICS_REFRESH_TZ=UTC

# -----------------------------------------------------------------------------
# Media Storage
# -----------------------------------------------------------------------------
# local | s3
MEDIA_STORAGE_DRIVER=s3
MEDIA_MAX_FILES=5
MEDIA_MAX_IMAGE_MB=10
MEDIA_MAX_VIDEO_MB=50
MEDIA_ALLOWED_MIME=image/*,video/*

# Local storage settings (used only when MEDIA_STORAGE_DRIVER=local)
MEDIA_LOCAL_DIR=.uploads
MEDIA_PUBLIC_BASE_URL=https://<backend-domain>
# Optional. Falls back to JWT_SECRET if omitted.
MEDIA_UPLOAD_SIGNING_SECRET=replace-with-random-secret
MEDIA_UPLOAD_TOKEN_TTL_SECONDS=600

# S3-compatible settings (required when MEDIA_STORAGE_DRIVER=s3)
AWS_ENDPOINT_URL=https://t3.storageapi.dev
AWS_PUBLIC_ENDPOINT_URL=https://t3.storageapi.dev
AWS_S3_BUCKET_NAME=your-bucket-name
AWS_DEFAULT_REGION=auto
AWS_ACCESS_KEY_ID=your-access-key-id
AWS_SECRET_ACCESS_KEY=your-secret-access-key
AWS_S3_FORCE_PATH_STYLE=true
AWS_S3_READ_URL_TTL_SECONDS=300

# -----------------------------------------------------------------------------
# Optional Admin Access
# -----------------------------------------------------------------------------
# Comma-separated Telegram user IDs.
ADMIN_TELEGRAM_IDS=
