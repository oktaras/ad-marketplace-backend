# =============================================================================
# Ads Marketplace Backend Environment (Railway API/Worker/Bot)
# =============================================================================
# Use the same variable set for:
# - Railway service using /backend/Dockerfile.api
# - Railway service using /backend/Dockerfile.worker
# - Railway service using /backend/Dockerfile.bot

# -----------------------------------------------------------------------------
# Core Runtime
# -----------------------------------------------------------------------------
NODE_ENV=production
PORT=3000
DATABASE_URL=postgresql://USER:PASSWORD@HOST:5432/DB_NAME?sslmode=require
REDIS_URL=rediss://default:PASSWORD@HOST:6379
JWT_SECRET=replace-with-strong-random-secret
CORS_ORIGINS=https://<frontend-domain>,https://telegram.org,https://web.telegram.org
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=100

# -----------------------------------------------------------------------------
# Telegram
# -----------------------------------------------------------------------------
TELEGRAM_BOT_TOKEN=
TELEGRAM_BOT_USERNAME=your_bot_username
# Frontend Mini App base URL used for TonConnect manifest links:
# - url: <MINI_APP_BASE_URL>/
# - iconUrl: <MINI_APP_BASE_URL>/tonconnect-icon.png
# - termsOfUseUrl: <MINI_APP_BASE_URL>/terms
# - privacyPolicyUrl: <MINI_APP_BASE_URL>/privacy
MINI_APP_BASE_URL=https://<frontend-domain>
DEAL_CHAT_DELETE_TOPICS_ON_CLOSE=true

# Optional MTProto analytics access
TELEGRAM_API_ID=
TELEGRAM_API_HASH=
MTPROTO_SESSION_ENCRYPTION_KEY=

# -----------------------------------------------------------------------------
# TON / Escrow
# -----------------------------------------------------------------------------
TON_NETWORK=testnet
TON_CENTER_API_URL=https://testnet.toncenter.com/api/v2/jsonRPC
TON_CENTER_API_KEY=
PLATFORM_FEE_WALLET_ADDRESS=
PLATFORM_MNEMONIC=
BACKEND_WALLET_MNEMONIC=
BACKEND_WALLET_ADDRESS=
ESCROW_FACTORY_ADDRESS=
VERIFICATION_SIGNER_SECRET=
PLATFORM_FEE_BPS=500
PLATFORM_FEE_PERCENT=5

# -----------------------------------------------------------------------------
# Currency
# -----------------------------------------------------------------------------
SUPPORTED_CURRENCIES=TON
DEFAULT_CURRENCY=TON

# -----------------------------------------------------------------------------
# Worker Scheduling (used by worker runtime)
# -----------------------------------------------------------------------------
ANALYTICS_REFRESH_ENABLED=true
ANALYTICS_REFRESH_CRON=0 3 * * *
ANALYTICS_REFRESH_TZ=UTC

# -----------------------------------------------------------------------------
# Media Storage
# -----------------------------------------------------------------------------
# Railway bucket (S3-compatible) is recommended for production:
MEDIA_STORAGE_DRIVER=s3
MEDIA_MAX_FILES=5
MEDIA_MAX_IMAGE_MB=10
MEDIA_MAX_VIDEO_MB=50
MEDIA_ALLOWED_MIME=image/*,video/*

# Local storage settings (used only when MEDIA_STORAGE_DRIVER=local)
MEDIA_LOCAL_DIR=.uploads
MEDIA_PUBLIC_BASE_URL=https://<backend-domain>
MEDIA_UPLOAD_SIGNING_SECRET=replace-with-random-secret
MEDIA_UPLOAD_TOKEN_TTL_SECONDS=600

# Railway bucket settings (required when MEDIA_STORAGE_DRIVER=s3)
# Browser upload CORS: allow frontend origin for PUT/GET/HEAD/OPTIONS and headers Content-Type,x-amz-*
# Public read URLs are served via backend signed proxy: https://<backend-domain>/api/media/s3/<storageKey>
AWS_ENDPOINT_URL=https://t3.storageapi.dev
AWS_S3_BUCKET_NAME=practical-thermos-aphxvps
AWS_DEFAULT_REGION=auto
AWS_ACCESS_KEY_ID=tid_RudzOWvtDDgipbAhTNQzntlOSJIsHtwKorWqveWDSBhrxLtgNQ
AWS_SECRET_ACCESS_KEY=tsec_yTKP25lnv9M_7_TmvePjis+2TkpQzJLgd-3EhiE78cgeg8vcy4lZSg-ACmp4uRlwJmkunx
MEDIA_S3_FORCE_PATH_STYLE=true

# -----------------------------------------------------------------------------
# Optional Admin Access
# -----------------------------------------------------------------------------
ADMIN_TELEGRAM_IDS=
